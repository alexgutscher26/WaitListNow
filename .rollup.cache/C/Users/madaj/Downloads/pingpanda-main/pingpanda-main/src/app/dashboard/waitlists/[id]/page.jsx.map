{"version":3,"file":"page.jsx","sourceRoot":"","sources":["page.tsx"],"names":[],"mappings":"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","sourcesContent":["import { notFound, redirect } from 'next/navigation';\r\nimport { currentUser } from '@clerk/nextjs/server';\r\nimport { db } from '@/lib/db';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { WaitlistSettingsForm } from '@/components/waitlist/waitlist-settings-form';\r\nimport { EmailSettingsForm } from '@/components/waitlist/email-settings-form';\r\nimport { DangerZone } from '@/components/waitlist/danger-zone';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Eye, Users, BarChart, Settings, ArrowLeft } from 'lucide-react';\r\nimport Link from 'next/link';\r\nimport { formatDistanceToNow } from 'date-fns';\r\nimport { SubscriberGrowthChart } from '@/components/subscriber-growth-chart';\r\nimport { SubscribersTable } from '@/components/subscribers-table';\r\n\r\ninterface WaitlistDetailPageProps {\r\n  params: { id: string };\r\n}\r\n\r\nexport default async function WaitlistDetailPage({ params }: WaitlistDetailPageProps) {\r\n  const { id } = params;\r\n  // Get the authenticated user\r\n  const user = await currentUser();\r\n\r\n  if (!user) {\r\n    redirect('/sign-in');\r\n  }\r\n\r\n  // Get the database user\r\n  const dbUser = await db.user.findUnique({\r\n    where: { externalId: user.id },\r\n  });\r\n\r\n  if (!dbUser) {\r\n    console.error('User not found in database');\r\n    notFound();\r\n  }\r\n\r\n  // Find the waitlist and verify ownership\r\n  const waitlist = await db.waitlist.findFirst({\r\n    where: {\r\n      id,\r\n      userId: dbUser.id,\r\n    },\r\n    include: {\r\n      _count: {\r\n        select: {\r\n          subscribers: true,\r\n        },\r\n      },\r\n    },\r\n  });\r\n\r\n  if (!waitlist) {\r\n    notFound();\r\n  }\r\n\r\n  // Get subscriber statistics\r\n  const oneWeekAgo = new Date();\r\n  oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);\r\n  const oneDayAgo = new Date();\r\n  oneDayAgo.setDate(oneDayAgo.getDate() - 1);\r\n\r\n  // Get basic stats and recent subscribers first\r\n  const [recentSubscribers, subscriberStats] = await Promise.all([\r\n    db.subscriber.findMany({\r\n      where: {\r\n        waitlistId: waitlist.id,\r\n      },\r\n      orderBy: {\r\n        createdAt: 'desc',\r\n      },\r\n      take: 5,\r\n    }),\r\n    db.$queryRaw`\r\n      SELECT \r\n        COUNT(*) as total,\r\n        SUM(CASE WHEN \"createdAt\" > ${oneWeekAgo} THEN 1 ELSE 0 END) as new_this_week,\r\n        SUM(CASE WHEN \"createdAt\" > ${oneDayAgo} THEN 1 ELSE 0 END) as new_today\r\n      FROM \"Subscriber\"\r\n      WHERE \"waitlistId\" = ${waitlist.id}\r\n    ` as Promise<\r\n      Array<{\r\n        total: bigint;\r\n        new_this_week: bigint;\r\n        new_today: bigint;\r\n      }>\r\n    >,\r\n  ]);\r\n\r\n  // Growth data will be loaded client-side by the SubscriberGrowthChart component\r\n\r\n  const stats = subscriberStats[0];\r\n  const totalSubscribers = Number(stats.total);\r\n  const newThisWeek = Number(stats.new_this_week);\r\n  const newToday = Number(stats.new_today);\r\n\r\n  // Calculate growth rate (this week vs last week)\r\n  const lastWeekStart = new Date();\r\n  lastWeekStart.setDate(lastWeekStart.getDate() - 14);\r\n  const lastWeekEnd = new Date();\r\n  lastWeekEnd.setDate(lastWeekEnd.getDate() - 7);\r\n\r\n  const lastWeekCount = await db.subscriber.count({\r\n    where: {\r\n      waitlistId: waitlist.id,\r\n      createdAt: {\r\n        gte: lastWeekStart,\r\n        lte: lastWeekEnd,\r\n      },\r\n    },\r\n  });\r\n\r\n  const growthRate =\r\n    lastWeekCount > 0\r\n      ? Math.round(((newThisWeek - lastWeekCount) / lastWeekCount) * 100)\r\n      : newThisWeek > 0\r\n        ? 100\r\n        : 0;\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <div className=\"flex items-center space-x-4\">\r\n          <Button\r\n            variant=\"ghost\"\r\n            size=\"icon\"\r\n            asChild\r\n          >\r\n            <Link href=\"/dashboard/waitlists\">\r\n              <ArrowLeft className=\"h-4 w-4\" />\r\n            </Link>\r\n          </Button>\r\n          <div>\r\n            <h1 className=\"text-2xl font-bold\">{waitlist.name}</h1>\r\n            <p className=\"text-muted-foreground\">{waitlist._count.subscribers} total subscribers</p>\r\n          </div>\r\n        </div>\r\n        <div className=\"flex space-x-2\">\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            asChild\r\n          >\r\n            <Link\r\n              href={`/waitlist/${waitlist.slug}`}\r\n              target=\"_blank\"\r\n            >\r\n              <Eye className=\"mr-2 h-4 w-4\" />\r\n              View Live\r\n            </Link>\r\n          </Button>\r\n          <Button\r\n            size=\"sm\"\r\n            asChild\r\n          >\r\n            <Link href={`/dashboard/waitlists/${waitlist.id}/edit`}>\r\n              <Settings className=\"mr-2 h-4 w-4\" />\r\n              Settings\r\n            </Link>\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      <Tabs\r\n        defaultValue=\"overview\"\r\n        className=\"space-y-4\"\r\n      >\r\n        <TabsList>\r\n          <TabsTrigger value=\"overview\">\r\n            <BarChart className=\"mr-2 h-4 w-4\" />\r\n            Overview\r\n          </TabsTrigger>\r\n          <TabsTrigger value=\"subscribers\">\r\n            <Users className=\"mr-2 h-4 w-4\" />\r\n            Subscribers\r\n          </TabsTrigger>\r\n          <TabsTrigger value=\"settings\">\r\n            <Settings className=\"mr-2 h-4 w-4\" />\r\n            Settings\r\n          </TabsTrigger>\r\n        </TabsList>\r\n\r\n        <TabsContent\r\n          value=\"overview\"\r\n          className=\"space-y-4\"\r\n        >\r\n          <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\r\n            <Card>\r\n              <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                <CardTitle className=\"text-sm font-medium\">Total Subscribers</CardTitle>\r\n                <Users className=\"h-4 w-4 text-muted-foreground\" />\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"text-2xl font-bold\">{totalSubscribers.toLocaleString()}</div>\r\n                <p className=\"text-xs text-muted-foreground\">\r\n                  {newThisWeek > 0 ? `+${newThisWeek} this week` : 'No new subscribers this week'}\r\n                </p>\r\n              </CardContent>\r\n            </Card>\r\n            <Card>\r\n              <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                <CardTitle className=\"text-sm font-medium\">Growth Rate</CardTitle>\r\n                <BarChart className=\"h-4 w-4 text-muted-foreground\" />\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"text-2xl font-bold\">\r\n                  {growthRate >= 0 ? '+' : ''}\r\n                  {growthRate}%\r\n                </div>\r\n                <p className=\"text-xs text-muted-foreground\">\r\n                  {newThisWeek > 0 ? `+${newThisWeek} this week` : 'No growth'}\r\n                </p>\r\n              </CardContent>\r\n            </Card>\r\n            <Card>\r\n              <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                <CardTitle className=\"text-sm font-medium\">Active Now</CardTitle>\r\n                <div className=\"h-2 w-2 rounded-full bg-green-500\" />\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"text-2xl font-bold\">{newToday}</div>\r\n                <p className=\"text-xs text-muted-foreground\">\r\n                  {newToday > 0 ? `+${newToday} today` : 'No new subscribers today'}\r\n                </p>\r\n              </CardContent>\r\n            </Card>\r\n            <Card>\r\n              <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\r\n                <CardTitle className=\"text-sm font-medium\">Status</CardTitle>\r\n                <span className=\"h-4 w-4 text-muted-foreground\">📊</span>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"text-2xl font-bold capitalize\">{waitlist.status.toLowerCase()}</div>\r\n                <p className=\"text-xs text-muted-foreground\">\r\n                  Last updated{' '}\r\n                  {formatDistanceToNow(new Date(waitlist.updatedAt), { addSuffix: true })}\r\n                </p>\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n\r\n          <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-7\">\r\n            <div className=\"col-span-4\">\r\n              <SubscriberGrowthChart\r\n                waitlistId={id}\r\n                className=\"w-full\"\r\n                days={30}\r\n              />\r\n            </div>\r\n            <Card className=\"col-span-3\">\r\n              <CardHeader>\r\n                <CardTitle>Recent Subscribers</CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                {recentSubscribers.length > 0 ? (\r\n                  <div className=\"space-y-4\">\r\n                    {recentSubscribers.map((subscriber) => (\r\n                      <div\r\n                        key={subscriber.id}\r\n                        className=\"flex items-center\"\r\n                      >\r\n                        <div className=\"space-y-1\">\r\n                          <p className=\"text-sm font-medium leading-none\">{subscriber.email}</p>\r\n                          <p className=\"text-sm text-muted-foreground\">\r\n                            {new Date(subscriber.createdAt).toLocaleDateString()}\r\n                          </p>\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                ) : (\r\n                  <p className=\"text-sm text-muted-foreground\">No subscribers yet</p>\r\n                )}\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n        </TabsContent>\r\n\r\n        <TabsContent\r\n          value=\"subscribers\"\r\n          className=\"space-y-4\"\r\n        >\r\n          <Card>\r\n            <CardHeader>\r\n              <CardTitle>Subscribers</CardTitle>\r\n              <p className=\"text-sm text-muted-foreground\">\r\n                View and manage your waitlist subscribers\r\n              </p>\r\n            </CardHeader>\r\n            <CardContent>\r\n              <SubscribersTable waitlistId={waitlist.id} />\r\n            </CardContent>\r\n          </Card>\r\n        </TabsContent>\r\n\r\n        <TabsContent\r\n          value=\"settings\"\r\n          className=\"space-y-6\"\r\n        >\r\n          <div className=\"space-y-6\">\r\n            {/* General Settings */}\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle>General Settings</CardTitle>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <WaitlistSettingsForm\r\n                  waitlist={{\r\n                    id: waitlist.id,\r\n                    name: waitlist.name,\r\n                    slug: waitlist.slug,\r\n                    description: waitlist.description,\r\n                  }}\r\n                />\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Email Settings */}\r\n            <Card>\r\n              <CardHeader>\r\n                <CardTitle>Email Settings</CardTitle>\r\n                <p className=\"text-sm text-muted-foreground\">\r\n                  Customize email notifications and confirmations\r\n                </p>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <EmailSettingsForm\r\n                  waitlist={{\r\n                    id: waitlist.id,\r\n                    customFields: waitlist.customFields as {\r\n                      sendConfirmationEmail?: boolean;\r\n                      customThankYouMessage?: string;\r\n                    } | null,\r\n                  }}\r\n                />\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Danger Zone */}\r\n            <Card className=\"border-red-200 bg-red-50\">\r\n              <CardHeader>\r\n                <CardTitle className=\"text-red-700\">Danger Zone</CardTitle>\r\n                <p className=\"text-sm text-red-600\">\r\n                  These actions are irreversible. Proceed with caution.\r\n                </p>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <DangerZone\r\n                  waitlistId={waitlist.id}\r\n                  waitlistName={waitlist.name}\r\n                />\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n        </TabsContent>\r\n      </Tabs>\r\n    </div>\r\n  );\r\n}\r\n"]}