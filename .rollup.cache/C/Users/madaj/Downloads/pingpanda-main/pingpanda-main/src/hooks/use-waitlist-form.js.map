{"version":3,"file":"use-waitlist-form.js","sourceRoot":"","sources":["use-waitlist-form.ts"],"names":[],"mappings":"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","sourcesContent":["import { useState, useCallback } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { toast } from '@/components/ui/use-toast';\r\nimport { WaitlistFormValues } from '@/lib/validations/waitlist';\r\nimport { createWaitlist } from '@/lib/api/waitlists';\r\n\r\nconst defaultValues: WaitlistFormValues = {\r\n  name: '',\r\n  description: '',\r\n  websiteUrl: '',\r\n  redirectUrl: '',\r\n  customFields: [],\r\n  style: {\r\n    buttonText: 'Join Waitlist',\r\n    buttonColor: '#3b82f6',\r\n    buttonTextColor: '#ffffff',\r\n    backgroundColor: '#ffffff',\r\n    textColor: '#1f2937',\r\n    borderRadius: 8,\r\n    fontFamily: 'Inter',\r\n    showLabels: true,\r\n    formLayout: 'stacked',\r\n  },\r\n  settings: {\r\n    emailVerification: true,\r\n    allowDuplicates: false,\r\n    referralEnabled: false,\r\n  },\r\n};\r\n\r\nexport function useWaitlistForm(initialValues: Partial<WaitlistFormValues> = {}) {\r\n  const router = useRouter();\r\n  const [formData, setFormData] = useState<WaitlistFormValues>({\r\n    ...defaultValues,\r\n    ...initialValues,\r\n  });\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [errors, setErrors] = useState<Record<string, string>>({});\r\n\r\n  const handleChange = useCallback(\r\n    (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement>) => {\r\n      const { name, value, type } = e.target as HTMLInputElement;\r\n\r\n      setFormData((prev) => ({\r\n        ...prev,\r\n        [name]: type === 'checkbox' ? (e.target as HTMLInputElement).checked : value,\r\n      }));\r\n\r\n      // Clear error when user starts typing\r\n      if (errors[name]) {\r\n        setErrors((prev) => {\r\n          const { [name]: _, ...rest } = prev;\r\n          return rest;\r\n        });\r\n      }\r\n    },\r\n    [errors],\r\n  );\r\n\r\n  const handleCustomFieldChange = useCallback((index: number, field: string, value: unknown) => {\r\n    setFormData((prev) => {\r\n      const updatedFields = [...prev.customFields];\r\n      updatedFields[index] = {\r\n        ...updatedFields[index],\r\n        [field]: value,\r\n      };\r\n      return {\r\n        ...prev,\r\n        customFields: updatedFields,\r\n      };\r\n    });\r\n  }, []);\r\n\r\n  const addCustomField = useCallback(() => {\r\n    setFormData((prev) => ({\r\n      ...prev,\r\n      customFields: [\r\n        ...prev.customFields,\r\n        {\r\n          id: `field-${Date.now()}`,\r\n          name: '',\r\n          type: 'text',\r\n          placeholder: '',\r\n          required: false,\r\n        },\r\n      ],\r\n    }));\r\n  }, []);\r\n\r\n  const removeCustomField = useCallback((index: number) => {\r\n    setFormData((prev) => ({\r\n      ...prev,\r\n      customFields: prev.customFields.filter((_, i) => i !== index),\r\n    }));\r\n  }, []);\r\n\r\n  const handleStyleChange = useCallback(<T extends keyof WaitlistFormValues['style']>(field: T, value: WaitlistFormValues['style'][T]) => {\r\n    setFormData((prev) => ({\r\n      ...prev,\r\n      style: {\r\n        ...prev.style,\r\n        [field]: value,\r\n      },\r\n    }));\r\n  }, []);\r\n\r\n  const handleSettingsChange = useCallback(<T extends keyof WaitlistFormValues['settings']>(field: T, value: WaitlistFormValues['settings'][T]) => {\r\n    setFormData((prev) => ({\r\n      ...prev,\r\n      settings: {\r\n        ...prev.settings,\r\n        [field]: value,\r\n      },\r\n    }));\r\n  }, []);\r\n\r\n  const validateForm = useCallback((): boolean => {\r\n    const newErrors: Record<string, string> = {};\r\n\r\n    if (!formData.name.trim()) {\r\n      newErrors.name = 'Waitlist name is required';\r\n    }\r\n\r\n    if (formData.websiteUrl && !isValidUrl(formData.websiteUrl)) {\r\n      newErrors.websiteUrl = 'Please enter a valid URL';\r\n    }\r\n\r\n    if (formData.redirectUrl && !isValidUrl(formData.redirectUrl)) {\r\n      newErrors.redirectUrl = 'Please enter a valid URL';\r\n    }\r\n\r\n    // Validate custom fields\r\n    formData.customFields.forEach((field, index) => {\r\n      if (!field.name.trim()) {\r\n        newErrors[`customFields.${index}.name`] = 'Field name is required';\r\n      }\r\n    });\r\n\r\n    setErrors(newErrors);\r\n    return Object.keys(newErrors).length === 0;\r\n  }, [formData]);\r\n\r\n  const handleSubmit = useCallback(async () => {\r\n    if (!validateForm()) {\r\n      return { success: false, error: 'Please fix the form errors' };\r\n    }\r\n\r\n    setIsSubmitting(true);\r\n\r\n    try {\r\n      const data = await createWaitlist(formData);\r\n\r\n      toast({\r\n        title: 'Success!',\r\n        description: 'Your waitlist has been created successfully.',\r\n      });\r\n\r\n      router.push(`/dashboard/waitlists/${data.id}`);\r\n      return { success: true, data };\r\n    } catch (error) {\r\n      console.error('Error creating waitlist:', error);\r\n      toast({\r\n        title: 'Error',\r\n        description: error instanceof Error ? error.message : 'Failed to create waitlist',\r\n        variant: 'destructive',\r\n      });\r\n      return { success: false, error };\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  }, [formData, router, validateForm]);\r\n\r\n  return {\r\n    formData,\r\n    setFormData,\r\n    errors,\r\n    isSubmitting,\r\n    handleChange,\r\n    handleCustomFieldChange,\r\n    handleStyleChange,\r\n    handleSettingsChange,\r\n    addCustomField,\r\n    removeCustomField,\r\n    handleSubmit,\r\n  };\r\n}\r\n\r\nfunction isValidUrl(url: string): boolean {\r\n  if (!url) return true;\r\n  try {\r\n    new URL(url);\r\n    return true;\r\n  } catch {\r\n    return false;\r\n  }\r\n}\r\n"]}